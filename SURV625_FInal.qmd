---
title: "Homework 1: Namit Shrivastava"
format: pdf
editor: visual
---

## 1. Select a simple random sample (SRS) of size n = 20 from this frame. Each student will select a different simple random sample, using the R code set.seed(the last four digits of your UM/UMD student ID). Note that we are simulating the notion of hypothetical repeated random sampling using the same SRS design! The class has 30 enrolled students and would generate 30 samples.

```{r}
library(readxl)
data <- read_excel("~/Downloads/fem1524_admin.xlsx")
set.seed(5570)
n <- 20
SRS <- data[sample(nrow(data), n), ]
SRS
```

I selected a simple random sample (SRS) of 20 individuals from the dataset using the R code provided. By setting the seed to 5570, I ensured that my sample is reproducible. The sample includes individuals with ages ranging from 16 to 24. Here are the first few entries: a 24-year-old with ID 1560, a 16-year-old with ID 2783, and a 22-year-old with ID 490. This process simulates the notion of hypothetical repeated random sampling.

## 2. Give, in selection order, the list of the 20 four-digit selection number (IDs) and the values of AGE for the women in your sample.

```{r}
SRS_list <- SRS[, c("ID", "AGER")]
SRS_list
```

Here is the list of the 20 individuals selected in my sample, along with their ages. The IDs and ages are as follows: ID 1560 is 24 years old, ID 2783 is 16 years old, ID 490 is 22 years old, and so on. This sample provides a diverse range of ages, from 16 to 24, which will help in analyzing the characteristics of this population subset.

## 3. Compute the sample estimate of the mean age. What else would we need to compute (be specific) to make inference about the mean age of the population?

```{r}
mean_age <- mean(SRS_list$AGER)
mean_age
```

So to make inference, we also need the variance (specifically the standard error) of the sample mean.

```{r}
var_age <- var(SRS_list$AGER, na.rm = TRUE)
se_age <- sqrt(var_age / n)
se_age
```

## 4. What would we call the distribution that we would see if we plotted all 30 sample estimates of the mean age (computed from the 30 unique samples generated by the students in the class)? What would we call the standard deviation of this distribution?

Alright so if everyone in the class repeats this selection procedure, we will get 30 different sample means of age. The collection of those means is called the sampling distribution of the sample mean and its standard deviation will be called the standard error of the mean. So let me try to code this situation:

```{r}
n <- 20
num_samples <- 30
sample_means <- numeric(num_samples)

for (i in 1:num_samples) {
  set.seed(5570 + i)  # say different seed for each sample
  SRS <- data[sample(nrow(data), n), ]
  sample_means[i] <- mean(SRS$AGER)
}

# Plotting the distribution of sample means
hist(sample_means, main="Sampling Distribution of the Sample Mean", xlab="Sample Mean Age")

# Calculating the standard deviation of the sample means
std_error <- sd(sample_means)
std_error
```

## 5a) Look up the number of male sexual partners in the past year (PARTS1YR) that were reported in a survey by each of your 20 selections in the Excel file. Estimate the mean number of partners in the past year for the population.

```{r}
library(readxl)
hw_data <- read_excel("~/Downloads/SM 625 HW 1.xlsx")

# Filtering the rows that match SRS_list ID values
merged_data <- hw_data[hw_data$ID %in% SRS_list$ID, ]

# Computing the mean number of partners
mean_partners <- mean(merged_data$PARTS1YR, na.rm = TRUE)
mean_partners
```

I looked up the number of male sexual partners in the past year (PARTS1YR) for each of the 20 individuals in my sample from the provided Excel file. After filtering the data to match my sample IDs, I calculated the mean number of partners. The average number of male sexual partners reported in the past year for my sample is 0.8. This estimate gives us an idea of the average number of partners for the population subset we are studying.

## 5b) Estimate the population element variance

```{r}
variance_partners <- var(merged_data$PARTS1YR, na.rm = TRUE)
variance_partners
```

I calculated the population element variance for the number of male sexual partners in the past year (PARTS1YR) reported by my sample. The variance is approximately 0.274. This measure of variability indicates how much the number of partners varies among the individuals in my sample.

## 5c) Estimate the sampling variance of the mean and the standard error

```{r}
n <- 20
N <- 2920
f <- n / N # the finite population correction factor
var_mean <- (1 - f) * variance_partners / n
std_error <- sqrt(var_mean)
var_mean
std_error
```

I estimated the sampling variance of the mean number of male sexual partners in the past year. The sampling variance is approximately 0.0136, and the standard error is about 0.117. These values help us understand the precision of our sample mean estimate and how much it might vary if we were to take multiple samples from the population.

## 5d) Compute a 95% confidence interval for the sample mean

So the degrees of freedom here will be 20-1 = 19

```{r}
t_value <- qt(0.975, df = n - 1)
lower_bound <- mean_partners - t_value * std_error
upper_bound <- mean_partners + t_value * std_error
c(lower_bound, upper_bound)
```

I computed a 95% confidence interval for the sample mean number of male sexual partners in the past year. With 19 degrees of freedom, the interval ranges from approximately 0.556 to 1.044. This means we can be 95% confident that the true population mean lies within this range. This interval provides a measure of the uncertainty around our sample mean estimate.

## 5e) Explain why the mean computed in a) will generally not be equal to the population mean.

Ok so the mean computed in a) i.e. 0.8 will generally not be equal to the population mean because we only observe a subset of the population and the sample mean will differ from the true population mean due to randomness in the selection of the sample (i.e., sampling variation).

## 5f) Estimate the coefficient of variation of the mean

```{r}
cv_mean <- std_error / mean_partners
cv_mean
```

I estimated the coefficient of variation (CV) of the mean number of male sexual partners in the past year. The CV is approximately 0.146. This value indicates the relative variability of the sample mean in relation to the mean itself, providing a standardized measure of dispersion.

## 5g) What difference would it make for the sampling variance of the mean if the sample size were increased to n = 60?

```{r}
n_new <- 60
N <- 2920
f_new <- n_new / N
f_new
```

Increasing the sample size reduces the sampling variance because the formula (1 - f) \* s\^2 / n shrinks as n grows. Specifically, with n = 60, one would expect a smaller sampling variance and hence a smaller standard error compared to n = 20.

## 5h) What sample size is needed to obtain SE = 0.05 ? What about CV = 0.10 ? What about a 95% confidence interval with width 0.40 (using 2 for the t-value)?

Now CV and CI will be calculated as:

$$
\begin{aligned}
cv(\bar{y}) &= \frac{se(\bar{y})}{\bar{y}} = 0.1\\
&\implies se(\bar{y}) = 0.1\times \bar{y}\\
&\implies\frac{\sigma}{\sqrt{n}} = 0.1\times \bar{y}\text{  }\because\text{N>>n}\\
&\implies n = \frac{\sigma^2}{(0.1\times\bar{y})^2}
\end{aligned}
$$

and

$$
\begin{aligned}
CI Width&=2\times t\times se(\bar{y}) = 0.4\\
& \implies 2\times 2\times \frac{\sigma}{\sqrt{n}} = 0.4\because\text{ N>>n and give t=2}\\
& \implies (4\sigma/0.4)^2 = n
\end{aligned}
$$

```{r}
# For SE = 0.05
s2 <- variance_partners
N <- 2920

# For SE(ȳ) = 0.05
n_SE <- s2/(0.05^2)
n_SE <- ceiling(n_SE)
cat("The required sample size for SE(y) to be 0.05 is:\t", n_SE, "\n")

# For CV(ȳ) = 0.10
n_CV <- s2 / ((0.10 * mean_partners)^2)
n_CV <- ceiling(n_CV)
cat("The required sample size for CV(y) to be 0.10 is:\t", n_CV, "\n")

# For CI width = 0.40 (using t =  2)
n_CI <- (4*s2 / 0.40^2)
n_CI <- ceiling(n_CI)
cat("The sample size for width of 0.4 with t = 2 is:\t", n_CI, "\n")

# Results
c(n_SE, n_CV, n_CI)
```

Ok, for estimating the sample sizes for different conditions, I used the population variance, which is variance_partners here, rather than var_mean because it represents the population element variance, s\^2, which measures the variability of individual elements in the population. Whereas, using var_mean, which is the sampling variance of the mean adjusted for sample size, would lead to incorrect results since it already incorporates factors like the finite population correction.

## 5i) Estimate the mean number of male sexual partners in the past year (and its standard error) for the subclass of teenagers (age 15-19) in the sample. Ignore the finite population correction in the calculation of the standard error. How does this standard error compare to the standard error for the full sample? Would you expect such a difference? If so, why?

```{r}
# Filtering for teenagers
teens_data <- merged_data[merged_data$AGER >= 15 & merged_data$AGER <= 19, ]

# Calculating mean and SE for teens
teens_mean <- mean(teens_data$PARTS1YR, na.rm=TRUE)
teens_var <- var(teens_data$PARTS1YR, na.rm=TRUE)
teens_n <- nrow(teens_data)
teens_se <- sqrt(teens_var/teens_n)

c(teens_mean, teens_se)

# Now comparing with full sample SE (ignoring FPC)
full_se_no_fpc <- sqrt(variance_partners/n)
c(full_se_no_fpc, teens_se)
```

Ok so the SE for teenagers should be larger because of smaller sample size (subset), which generally leads to a larger standard error. Additionally, the variance within the teenage group may differ from the variance in the full sample, contributing to the difference in standard errors. Smaller, more homogeneous groups can exhibit different variances, which affects the standard error calculation.
